# commit-131 `hmr.accept`支持调用本身

输入：

```typescript
// # foo.js

import { hot } from '@hmr'

export const count = 1

hot.accept(newModule => {
  console.log('updated: count is now ', newModule.count)
})
```

输出：

```typescript
// foo.js

export const count = 1

hot.accept("/foo.js", "/foo.js", newModule => {
  console.log('updated: count is now ', newModule.count)
})
```

新增代码：

* `accept`的`callback`默认值`() =>  {}`，以防止`hot.accept('')`
* AST分析树，如果第一个参数类型是`FunctionExpression`，添加上`/foo.js`作为第二个参数。

> 对AST树有兴趣的，可以仔细研究一下。`mozila`有AST类型文档。使用的包`@babel/parser`，类型包`'@babel/types'`，最后使用`magic-string`替换。



# commit-132 v0.8.0

release v0.8.0



# commit-133 changelog

# [0.8.0](https://github.com/vuejs/vite/compare/v0.7.0...v0.8.0) (2020-04-30)

### Features

- 构建时，允许配置`rollupPluginVueOptions` ([a0053a0](https://github.com/vuejs/vite/commit/a0053a0eccd2659da685427ac3057cf5b436df80))
- `process.env.NODE_ENV` ([d4ccd15](https://github.com/vuejs/vite/commit/d4ccd154f54f71fb02e746924f9811d3a0e61a8f))
- `hmr.accept`支持调用本身 ([30ab444](https://github.com/vuejs/vite/commit/30ab444bd28b47eec1cf070a3c41116e8e9c64be))



# commit-134 [#24](https://github.com/vitejs/vite/pull/24) 语法调整

语法调整



# commit-135 [#26](https://github.com/vitejs/vite/pull/26) 修复错字

修复了在源代码中发现的一些错字



# commit-136 更新`rollup-plugin-vue` and `vue`包



![](./pkg.png)



# commit-137 fix `resolver ensurejs` check

现在可以知道`ensureJS`是什么东西了。

